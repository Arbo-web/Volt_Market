# Анализ ошибок в моделях приложения

## Обнаруженные ошибки

### 1. Ошибка в модели ProductModel (app/models/products.py)

**Проблема**: Неверный тип для связи `feedbacks` на строке 24.
```python
feedbacks: Mapped["FeedbacksModel"] = relationship(back_populates="product")
```

**Исправление**: Должно быть объявление списка для связи один-ко-многим:
```python
feedbacks: Mapped[list["FeedbacksModel"]] = relationship(back_populates="product")
```

### 2. Ошибка в модели UserModel (app/models/users.py)

**Проблема**: Лишние поля `feedback_id` и `feedback` на строках 24-25, которые создают некорректную и избыточную связь.

**Исправление**: Удалить эти строки, так как связь пользователя с отзывами уже определяется через модель FeedbacksModel, где пользователь связан как внешний ключ.

### 3. Отсутствие обратной связи в модели UserModel

**Проблема**: В модели FeedbacksModel есть ссылка на пользователя (`user: Mapped["UserModel"] = relationship(back_populates="feedbacks")`), но в модели UserModel нет соответствующего поля `feedbacks`, которое поддерживает эту связь.

**Исправление**: Добавить в модель UserModel поле для связи с отзывами:
```python
feedbacks: Mapped[list["FeedbacksModel"]] = relationship(back_populates="user")
```

## Рекомендуемая структура моделей

### ProductModel
- id: первичный ключ
- name: название продукта
- description: описание продукта
- image_url: URL изображения
- cost: цена
- quantity: количество
- characteristic_id: внешний ключ на характеристики
- characteristic: связь с моделью характеристик
- feedbacks: список отзывов (связь один ко многим)

### UserModel
- id: первичный ключ
- name: имя пользователя
- email: email (уникальный)
- hashed_password: хэшированный пароль
- image_url: URL аватара
- role_id: внешний ключ на роль
- role: связь с моделью роли
- feedbacks: список отзывов, оставленных пользователем (связь один ко многим)

### FeedbacksModel
- id: первичный ключ
- feedback: текст отзыва
- user_id: внешний ключ на пользователя
- product_id: внешний ключ на продукт
- user: связь с пользователем
- product: связь с продуктом

### CharacteristicsModel
- id: первичный ключ
- name: название характеристики
- value: значение характеристики
- products: список продуктов с этой характеристикой

### RoleModel
- id: первичный ключ
- name: название роли (уникальное)
- users: список пользователей с этой ролью

## Выводы

Текущая структура моделей имеет проблемы с целостностью связей между сущностями. После исправления ошибок, отношения между моделями будут корректно отражать бизнес-логику приложения: 
- один пользователь может оставлять много отзывов
- один продукт может иметь много отзывов
- один продукт может иметь одну характеристику
- один пользователь может иметь одну роль